<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chatbot - Hotel Andino</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"/>
  <style>
    * { box-sizing: border-box; }
    body { font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; background-color: #e6f0fa; }
    .chat-container { width: 100%; max-width: 420px; border-radius: 10px; background: #fff; box-shadow: 0px 4px 10px rgba(0,0,0,0.1); display: flex; flex-direction: column; overflow: hidden; }
    .chat-header { background: linear-gradient(135deg, #007bff, #0056b3); color: #fff; padding: 15px; text-align: center; font-weight: bold; }
    .messages { padding: 15px; height: 350px; overflow-y: auto; display: flex; flex-direction: column; background-color: #f0f7ff; }
    .messages div { margin: 5px 0; padding: 10px; border-radius: 8px; display: flex; align-items: center; animation: fadeIn 0.3s ease; }
    .user-msg { background-color: #cfe2ff; align-self: flex-end; flex-direction: row-reverse; }
    .bot-msg { background-color: #fff; align-self: flex-start; color: #007bff; border: 1px solid #d1e9ff; }
    .user-avatar, .bot-avatar { width: 30px; height: 30px; border-radius: 50%; margin: 0 10px; display: flex; align-items: center; justify-content: center; font-size: 16px; }
    .user-avatar { background-color: #007bff; color: #fff; }
    .bot-avatar { background-color: #d1e9ff; color: #007bff; }
    .input-box { display: flex; border-top: 1px solid #d1e9ff; background-color: #fff; }
    .input-box input { flex: 1; padding: 15px; border: none; font-size: 16px; background-color: #e6f0fa; border-radius: 0 0 0 10px; }
    .input-box button { padding: 15px 20px; background: #007bff; color: #fff; border: none; font-size: 16px; cursor: pointer; border-radius: 0 0 10px 0; transition: background 0.2s ease; }
    .input-box button:hover { background: #0056b3; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body>
  <div class="chat-container">
    <div class="chat-header">Chat con Hotel Andino</div>
    <div id="messages" class="messages"></div>
    <div class="input-box">
      <input type="text" id="userInput" placeholder="Escribe un mensaje..." />
      <button onclick="sendMessage()">Enviar</button>
    </div>
  </div>
  <script>
    const respuestas = {
      "hola":"¡Hola! Bienvenido a Hotel Andino. ¿En qué puedo ayudarte hoy?",
      "buenos días":"¡Buenos días! ¿Te gustaría reservar o conocer nuestros servicios?",
      "reservar":"Para reservar, indícame fecha de llegada y salida.",
      "precios":"Nuestros precios cambian según temporada y tipo de habitación. ¿Quieres ver la lista?",
      "servicios":"Tenemos WiFi, desayuno, piscina y gimnasio. ¿Deseas más detalles?",
      "habitaciones":"Ofrecemos estándar, dobles y suites. ¿Cuál prefieres?",
      "ubicación":"Estamos en el centro de la ciudad, cerca de los principales atractivos.",
      "contacto":"Escríbenos a contacto@hotelandino.com o llama al +57 000 000 0000.",
      "gracias":"¡Con gusto! Aquí estoy si necesitas algo más.",
      "adiós":"¡Gracias por contactarnos! Que tengas un excelente día.",
      "default":"Lo siento, no entendí eso. Intentémoslo con otra consulta."
    };

    async function sendMessage(){
      const inpt=document.getElementById('userInput');
      const txt=inpt.value.trim().toLowerCase();
      if(!txt)return;
      mostrarMens('user',txt);
      inpt.value='';

      let resp = respuestas["default"];
      for(const key in respuestas){
        if(key!=="default" && txt.includes(key)){ resp=respuestas[key]; break; }
      }

      if(resp===respuestas["default"]){
        try{
          const r=await fetch('send_to_groq.php',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:txt})});
          if(r.ok){
            const d=await r.json();
            resp = d.reply || "Lo siento, no entiendo eso.";
          } else resp="Error en el servidor. Inténtalo de nuevo.";
        } catch(e){
          console.error(e);
          resp="Error de conexión. Inténtalo luego.";
        }
      }

      setTimeout(()=>mostrarMens('bot',resp),300);
    }

    function mostrarMens(sender, texto){
      const cont=document.getElementById('messages');
      const div=document.createElement('div');
      const avatar=document.createElement('div');
      const icon=document.createElement('i');
      div.className=sender==='user'?'user-msg':'bot-msg';
      avatar.className=sender==='user'?'user-avatar':'bot-avatar';
      icon.className=sender==='user'?'fas fa-user':'fas fa-robot';
      avatar.appendChild(icon);
      div.appendChild(avatar);
      div.appendChild(document.createTextNode(texto));
      cont.appendChild(div);
      cont.scrollTop=cont.scrollHeight;
    }

    document.getElementById('userInput').addEventListener('keypress', function(e){ if(e.key==='Enter')sendMessage(); });
  </script>
</body>
</html>
